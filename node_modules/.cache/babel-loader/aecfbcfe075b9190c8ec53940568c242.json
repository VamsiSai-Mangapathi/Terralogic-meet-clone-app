{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Vamsisai-2994\\\\REACT\\\\google-meet-clone\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport Adminpage from './components/UserVideo/Adminpage';\nimport MainScreen from \"./components/MainScreen/MainScreen.component\";\nimport Registration from './components/Forms/Registration';\nimport { Route, Redirect, Switch } from 'react-router-dom';\nimport React from 'react';\nimport Home from './components/Kyathi/Home';\nimport Mainform from './components/Forms/Mainform';\nimport firepadRef, { db, userName } from \"./server/firebase\";\nimport \"./App.css\";\nimport { useEffect } from \"react\";\nimport { setMainStream, addParticipant, setUser, removeParticipant, updateParticipant } from \"./store/actioncreator\";\nimport { connect } from \"react-redux\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App(props) {\n  _s();\n  // const userName=window.localStorage.getItem(\"username\");\n  const getUserStream = async () => {\n    const localStream = await navigator.mediaDevices.getUserMedia({\n      audio: true,\n      video: true\n    });\n    return localStream;\n  };\n  useEffect(async () => {\n    const stream = await getUserStream();\n    stream.getVideoTracks()[0].enabled = false;\n    props.setMainStream(stream);\n    connectedRef.on(\"value\", snap => {\n      if (snap.val()) {\n        const defaultPreference = {\n          audio: true,\n          video: false,\n          screen: false\n        };\n        const userStatusRef = participantRef.push({\n          preferences: defaultPreference\n        });\n        props.setUser({\n          [userStatusRef.key]: {\n            ...defaultPreference\n          }\n        });\n        userStatusRef.onDisconnect().remove();\n      }\n    });\n  }, []);\n  const connectedRef = db.database().ref(\".info/connected\");\n  const participantRef = firepadRef.child(\"participants\");\n  const isUserSet = !!props.user;\n  const isStreamSet = !!props.stream;\n  useEffect(() => {\n    if (isStreamSet && isUserSet) {\n      participantRef.on(\"child_added\", snap => {\n        const preferenceUpdateEvent = participantRef.child(snap.key).child(\"preferences\");\n        preferenceUpdateEvent.on(\"child_changed\", preferenceSnap => {\n          props.updateParticipant({\n            [snap.key]: {\n              [preferenceSnap.key]: preferenceSnap.val()\n            }\n          });\n        });\n        const {\n          preferences = {}\n        } = snap.val();\n        props.addParticipant({\n          [snap.key]: {\n            ...preferences\n          }\n        });\n      });\n      participantRef.on(\"child_removed\", snap => {\n        props.removeParticipant(snap.key);\n      });\n    }\n  }, [isStreamSet, isUserSet]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: /*#__PURE__*/_jsxDEV(Route, {\n      children: /*#__PURE__*/_jsxDEV(Switch, {\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          path: \"/\",\n          exact: true,\n          children: /*#__PURE__*/_jsxDEV(Redirect, {\n            to: \"/login\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/login\",\n          children: /*#__PURE__*/_jsxDEV(Mainform, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/Registration\",\n          children: /*#__PURE__*/_jsxDEV(Registration, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/after\",\n          exact: true,\n          children: /*#__PURE__*/_jsxDEV(Home, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/:id\",\n          children: /*#__PURE__*/_jsxDEV(MainScreen, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 86,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"3ubReDTFssvu4DHeldAg55cW/CI=\");\n_c = App;\nconst mapStateToProps = state => {\n  return {\n    stream: state.mainStream,\n    user: state.currentUser\n  };\n};\nconst mapDispatchToProps = dispatch => {\n  return {\n    setMainStream: stream => dispatch(setMainStream(stream)),\n    addParticipant: user => dispatch(addParticipant(user)),\n    setUser: user => dispatch(setUser(user)),\n    removeParticipant: userId => dispatch(removeParticipant(userId)),\n    updateParticipant: user => dispatch(updateParticipant(user))\n  };\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["Adminpage","MainScreen","Registration","Route","Redirect","Switch","React","Home","Mainform","firepadRef","db","userName","useEffect","setMainStream","addParticipant","setUser","removeParticipant","updateParticipant","connect","App","props","getUserStream","localStream","navigator","mediaDevices","getUserMedia","audio","video","stream","getVideoTracks","enabled","connectedRef","on","snap","val","defaultPreference","screen","userStatusRef","participantRef","push","preferences","key","onDisconnect","remove","database","ref","child","isUserSet","user","isStreamSet","preferenceUpdateEvent","preferenceSnap","mapStateToProps","state","mainStream","currentUser","mapDispatchToProps","dispatch","userId"],"sources":["C:/Users/Vamsisai-2994/REACT/google-meet-clone/src/App.js"],"sourcesContent":["import Adminpage from './components/UserVideo/Adminpage';\r\nimport MainScreen from \"./components/MainScreen/MainScreen.component\"\r\nimport Registration from './components/Forms/Registration';\r\nimport {Route,Redirect,Switch} from 'react-router-dom';\r\nimport React from 'react';\r\nimport Home from './components/Kyathi/Home';\r\nimport Mainform from './components/Forms/Mainform';\r\nimport firepadRef, {db,userName} from \"./server/firebase\";\r\nimport \"./App.css\";\r\nimport { useEffect } from \"react\";\r\nimport {\r\n  setMainStream,\r\n  addParticipant,\r\n  setUser,\r\n  removeParticipant,\r\n  updateParticipant,\r\n} from \"./store/actioncreator\";\r\nimport { connect } from \"react-redux\";\r\n\r\nfunction App(props) {\r\n  // const userName=window.localStorage.getItem(\"username\");\r\n  const getUserStream = async () => {\r\n    const localStream = await navigator.mediaDevices.getUserMedia({\r\n      audio: true,\r\n      video: true,\r\n    });\r\n\r\n    return localStream;\r\n  };\r\n  useEffect(async () => {\r\n    const stream = await getUserStream();\r\n    stream.getVideoTracks()[0].enabled = false;\r\n    props.setMainStream(stream);\r\n\r\n    connectedRef.on(\"value\", (snap) => {\r\n      if (snap.val()) {\r\n        const defaultPreference = {\r\n          audio: true,\r\n          video: false,\r\n          screen: false,\r\n        };\r\n        const userStatusRef = participantRef.push({\r\n          preferences: defaultPreference,\r\n        });\r\n        props.setUser({\r\n          [userStatusRef.key]: {  ...defaultPreference },\r\n        });\r\n        userStatusRef.onDisconnect().remove();\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  const connectedRef = db.database().ref(\".info/connected\");\r\n  const participantRef = firepadRef.child(\"participants\");\r\n\r\n  const isUserSet = !!props.user;\r\n  const isStreamSet = !!props.stream;\r\n\r\n  useEffect(() => {\r\n    if (isStreamSet && isUserSet) {\r\n      participantRef.on(\"child_added\", (snap) => {\r\n        const preferenceUpdateEvent = participantRef\r\n          .child(snap.key)\r\n          .child(\"preferences\");\r\n        preferenceUpdateEvent.on(\"child_changed\", (preferenceSnap) => {\r\n          props.updateParticipant({\r\n            [snap.key]: {\r\n              [preferenceSnap.key]: preferenceSnap.val(),\r\n            },\r\n          });\r\n        });\r\n        const {  preferences = {} } = snap.val();\r\n        props.addParticipant({\r\n          [snap.key]: {\r\n            ...preferences,\r\n          },\r\n        });\r\n      });\r\n      participantRef.on(\"child_removed\", (snap) => {\r\n        props.removeParticipant(snap.key);\r\n      });\r\n    }\r\n  }, [isStreamSet, isUserSet]);\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <Route>\r\n        <Switch>\r\n          <Route path=\"/\" exact>\r\n            <Redirect to=\"/login\" />\r\n          </Route>\r\n          <Route path=\"/login\">\r\n            <Mainform />\r\n          </Route>\r\n          <Route path=\"/Registration\">\r\n            <Registration />\r\n          </Route>\r\n          <Route path=\"/after\" exact>\r\n            <Home />\r\n          </Route>\r\n          <Route path=\"/:id\">\r\n            \r\n            <MainScreen />\r\n          </Route>\r\n        </Switch>\r\n      </Route>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    stream: state.mainStream,\r\n    user: state.currentUser,\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    setMainStream: (stream) => dispatch(setMainStream(stream)),\r\n    addParticipant: (user) => dispatch(addParticipant(user)),\r\n    setUser: (user) => dispatch(setUser(user)),\r\n    removeParticipant: (userId) => dispatch(removeParticipant(userId)),\r\n    updateParticipant: (user) => dispatch(updateParticipant(user)),\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}