{"ast":null,"code":"import _defineProperty from\"C:/Users/Vamsisai-2994/REACT/google-meet-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/Users/Vamsisai-2994/REACT/google-meet-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:/Users/Vamsisai-2994/REACT/google-meet-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Vamsisai-2994/REACT/google-meet-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import Adminpage from'./components/UserVideo/Adminpage';import MainScreen from\"./components/MainScreen/MainScreen.component\";import Registration from'./components/Forms/Registration';import{Route,Redirect,Switch}from'react-router-dom';import React from'react';import Home from'./components/Kyathi/Home';import Mainform from'./components/Forms/Mainform';import firepadRef,{db,userName}from\"./server/firebase\";import\"./App.css\";import{useEffect}from\"react\";import{setMainStream as _setMainStream,addParticipant as _addParticipant,setUser as _setUser,removeParticipant as _removeParticipant,updateParticipant as _updateParticipant}from\"./store/actioncreator\";import{connect}from\"react-redux\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(props){// const userName=window.localStorage.getItem(\"username\");\nvar getUserStream=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var localStream;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return navigator.mediaDevices.getUserMedia({audio:true,video:true});case 2:localStream=_context.sent;return _context.abrupt(\"return\",localStream);case 4:case\"end\":return _context.stop();}}},_callee);}));return function getUserStream(){return _ref.apply(this,arguments);};}();useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var stream;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getUserStream();case 2:stream=_context2.sent;stream.getVideoTracks()[0].enabled=false;props.setMainStream(stream);connectedRef.on(\"value\",function(snap){if(snap.val()){var defaultPreference={audio:true,video:false,screen:false};var userStatusRef=participantRef.push({preferences:defaultPreference});props.setUser(_defineProperty({},userStatusRef.key,_objectSpread({},defaultPreference)));userStatusRef.onDisconnect().remove();}});case 6:case\"end\":return _context2.stop();}}},_callee2);})),[]);var connectedRef=db.database().ref(\".info/connected\");var participantRef=firepadRef.child(\"participants\");var isUserSet=!!props.user;var isStreamSet=!!props.stream;useEffect(function(){if(isStreamSet&&isUserSet){participantRef.on(\"child_added\",function(snap){var preferenceUpdateEvent=participantRef.child(snap.key).child(\"preferences\");preferenceUpdateEvent.on(\"child_changed\",function(preferenceSnap){props.updateParticipant(_defineProperty({},snap.key,_defineProperty({},preferenceSnap.key,preferenceSnap.val())));});var _snap$val=snap.val(),_snap$val$preferences=_snap$val.preferences,preferences=_snap$val$preferences===void 0?{}:_snap$val$preferences;props.addParticipant(_defineProperty({},snap.key,_objectSpread({},preferences)));});participantRef.on(\"child_removed\",function(snap){props.removeParticipant(snap.key);});}},[isStreamSet,isUserSet]);return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsx(Route,{children:/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",exact:true,children:/*#__PURE__*/_jsx(Redirect,{to:\"/login\"})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",children:/*#__PURE__*/_jsx(Mainform,{})}),/*#__PURE__*/_jsx(Route,{path:\"/Registration\",children:/*#__PURE__*/_jsx(Registration,{})}),/*#__PURE__*/_jsx(Route,{path:\"/after\",children:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"/:id\",children:/*#__PURE__*/_jsx(MainScreen,{})})]})})});}var mapStateToProps=function mapStateToProps(state){return{stream:state.mainStream,user:state.currentUser};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{setMainStream:function setMainStream(stream){return dispatch(_setMainStream(stream));},addParticipant:function addParticipant(user){return dispatch(_addParticipant(user));},setUser:function setUser(user){return dispatch(_setUser(user));},removeParticipant:function removeParticipant(userId){return dispatch(_removeParticipant(userId));},updateParticipant:function updateParticipant(user){return dispatch(_updateParticipant(user));}};};export default connect(mapStateToProps,mapDispatchToProps)(App);","map":{"version":3,"names":["Adminpage","MainScreen","Registration","Route","Redirect","Switch","React","Home","Mainform","firepadRef","db","userName","useEffect","setMainStream","addParticipant","setUser","removeParticipant","updateParticipant","connect","App","props","getUserStream","navigator","mediaDevices","getUserMedia","audio","video","localStream","stream","getVideoTracks","enabled","connectedRef","on","snap","val","defaultPreference","screen","userStatusRef","participantRef","push","preferences","key","onDisconnect","remove","database","ref","child","isUserSet","user","isStreamSet","preferenceUpdateEvent","preferenceSnap","mapStateToProps","state","mainStream","currentUser","mapDispatchToProps","dispatch","userId"],"sources":["C:/Users/Vamsisai-2994/REACT/google-meet-clone/src/App.js"],"sourcesContent":["import Adminpage from './components/UserVideo/Adminpage';\r\nimport MainScreen from \"./components/MainScreen/MainScreen.component\"\r\nimport Registration from './components/Forms/Registration';\r\nimport {Route,Redirect,Switch} from 'react-router-dom';\r\nimport React from 'react';\r\nimport Home from './components/Kyathi/Home';\r\nimport Mainform from './components/Forms/Mainform';\r\nimport firepadRef, {db,userName} from \"./server/firebase\";\r\nimport \"./App.css\";\r\nimport { useEffect } from \"react\";\r\nimport {\r\n  setMainStream,\r\n  addParticipant,\r\n  setUser,\r\n  removeParticipant,\r\n  updateParticipant,\r\n} from \"./store/actioncreator\";\r\nimport { connect } from \"react-redux\";\r\n\r\nfunction App(props) {\r\n  // const userName=window.localStorage.getItem(\"username\");\r\n  const getUserStream = async () => {\r\n    const localStream = await navigator.mediaDevices.getUserMedia({\r\n      audio: true,\r\n      video: true,\r\n    });\r\n\r\n    return localStream;\r\n  };\r\n  useEffect(async () => {\r\n    const stream = await getUserStream();\r\n    stream.getVideoTracks()[0].enabled = false;\r\n    props.setMainStream(stream);\r\n\r\n    connectedRef.on(\"value\", (snap) => {\r\n      if (snap.val()) {\r\n        const defaultPreference = {\r\n          audio: true,\r\n          video: false,\r\n          screen: false,\r\n        };\r\n        const userStatusRef = participantRef.push({\r\n          preferences: defaultPreference,\r\n        });\r\n        props.setUser({\r\n          [userStatusRef.key]: {  ...defaultPreference },\r\n        });\r\n        userStatusRef.onDisconnect().remove();\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  const connectedRef = db.database().ref(\".info/connected\");\r\n  const participantRef = firepadRef.child(\"participants\");\r\n\r\n  const isUserSet = !!props.user;\r\n  const isStreamSet = !!props.stream;\r\n\r\n  useEffect(() => {\r\n    if (isStreamSet && isUserSet) {\r\n      participantRef.on(\"child_added\", (snap) => {\r\n        const preferenceUpdateEvent = participantRef\r\n          .child(snap.key)\r\n          .child(\"preferences\");\r\n        preferenceUpdateEvent.on(\"child_changed\", (preferenceSnap) => {\r\n          props.updateParticipant({\r\n            [snap.key]: {\r\n              [preferenceSnap.key]: preferenceSnap.val(),\r\n            },\r\n          });\r\n        });\r\n        const {  preferences = {} } = snap.val();\r\n        props.addParticipant({\r\n          [snap.key]: {\r\n            ...preferences,\r\n          },\r\n        });\r\n      });\r\n      participantRef.on(\"child_removed\", (snap) => {\r\n        props.removeParticipant(snap.key);\r\n      });\r\n    }\r\n  }, [isStreamSet, isUserSet]);\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <Route>\r\n        <Switch>\r\n          <Route path=\"/\" exact>\r\n            <Redirect to=\"/login\" />\r\n          </Route>\r\n          <Route path=\"/login\">\r\n            <Mainform />\r\n          </Route>\r\n          <Route path=\"/Registration\">\r\n            <Registration />\r\n          </Route>\r\n          <Route path=\"/after\">\r\n            <Home />\r\n          </Route>\r\n          <Route path=\"/:id\">            \r\n            <MainScreen />\r\n          </Route>\r\n        </Switch>\r\n      </Route>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    stream: state.mainStream,\r\n    user: state.currentUser,\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    setMainStream: (stream) => dispatch(setMainStream(stream)),\r\n    addParticipant: (user) => dispatch(addParticipant(user)),\r\n    setUser: (user) => dispatch(setUser(user)),\r\n    removeParticipant: (userId) => dispatch(removeParticipant(userId)),\r\n    updateParticipant: (user) => dispatch(updateParticipant(user)),\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}